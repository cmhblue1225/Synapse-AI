# ğŸ”„ 09. ìƒíƒœ ê´€ë¦¬ íŒ¨í„´

## ğŸ¯ Zustand (í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ)

### ì™œ Zustand?

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | í¬ê¸° | ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ | TypeScript | ì„ íƒ |
|-----------|------|----------------|-----------|------|
| **Redux** | 47KB | ë§ìŒ | ë³´í†µ | âŒ |
| **MobX** | 16KB | ë³´í†µ | ì¢‹ìŒ | âŒ |
| **Zustand** | **2KB** | ìµœì†Œ | **ì™„ë²½** | âœ… |

### êµ¬í˜„ ì˜ˆì‹œ

```typescript
// src/stores/knowledge.store.ts
import { create } from 'zustand';

interface KnowledgeState {
  nodes: KnowledgeNode[];
  selectedNode: KnowledgeNode | null;
  filters: FilterOptions;
  
  setNodes: (nodes: KnowledgeNode[]) => void;
  setSelectedNode: (node: KnowledgeNode | null) => void;
  updateFilters: (filters: Partial<FilterOptions>) => void;
}

export const useKnowledgeStore = create<KnowledgeState>((set) => ({
  nodes: [],
  selectedNode: null,
  filters: {
    nodeType: '',
    sortOrder: 'updatedAt',
    searchQuery: ''
  },
  
  setNodes: (nodes) => set({ nodes }),
  setSelectedNode: (node) => set({ selectedNode: node }),
  updateFilters: (filters) => set((state) => ({
    filters: { ...state.filters, ...filters }
  }))
}));
```

---

## âš¡ React Query (ì„œë²„ ìƒíƒœ)

### ì„¤ì •

```typescript
// src/lib/queryClient.ts
import { QueryClient } from '@tanstack/react-query';

export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 5 * 60 * 1000,        // 5ë¶„
      gcTime: 10 * 60 * 1000,          // 10ë¶„
      refetchOnWindowFocus: false,
      retry: (failureCount, error) => {
        if (error?.status === 404) return false;
        return failureCount < 3;
      },
    },
  },
});
```

### ì‚¬ìš© ì˜ˆì‹œ

```typescript
// ë°ì´í„° ì¡°íšŒ
const { data: nodes, isLoading } = useQuery({
  queryKey: ['nodes', userId],
  queryFn: () => knowledgeService.getNodes(userId),
  enabled: !!userId
});

// ë°ì´í„° ìƒì„±
const createNodeMutation = useMutation({
  mutationFn: (newNode: CreateNodeRequest) =>
    knowledgeService.createNode(newNode),
  onSuccess: () => {
    queryClient.invalidateQueries({ queryKey: ['nodes'] });
    toast.success('ì§€ì‹ ë…¸ë“œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');
  },
});
```

---

## ğŸ’¡ ë©´ì ‘ í¬ì¸íŠ¸

### "Zustandë¥¼ ì„ íƒí•œ ì´ìœ ëŠ”?"
> "**2KB í¬ê¸°**ë¡œ ê°€ë³ê³ , **ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ê°€ ìµœì†Œ**ì´ë©°, **TypeScript ì™„ë²½ ì§€ì›**í•©ë‹ˆë‹¤. ReduxëŠ” 47KBë¡œ ê³¼ë„í•˜ê³  ì„¤ì •ì´ ë³µì¡í•©ë‹ˆë‹¤."

### "staleTime 5ë¶„ì˜ ì˜ë¯¸ëŠ”?"
> "ë°ì´í„°ê°€ **5ë¶„ê°„ fresh ìƒíƒœ**ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤. ê°™ì€ ë°ì´í„°ë¥¼ 5ë¶„ ë‚´ ì¬ì¡°íšŒí•˜ë©´ ìºì‹œëœ ë°ì´í„°ë¥¼ ì¦‰ì‹œ ë°˜í™˜í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ë°©ì§€í•©ë‹ˆë‹¤."

---

**ë‹¤ìŒ ë¬¸ì„œ**: [10. ì„±ëŠ¥ ìµœì í™”](./10_ì„±ëŠ¥_ìµœì í™”.md)
**ì´ì „ ë¬¸ì„œ**: [08. í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„](./08_í•µì‹¬_ê¸°ëŠ¥_êµ¬í˜„.md)
