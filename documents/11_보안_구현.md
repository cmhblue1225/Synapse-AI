# π” 11. λ³΄μ• κµ¬ν„

## π›΅οΈ Row Level Security (RLS)

### μ •μ±… μμ‹

```sql
-- μ‚¬μ©μλ” μμ‹ μ λ°μ΄ν„°λ§ μ ‘κ·Ό
CREATE POLICY "Users can manage own nodes"
ON knowledge_nodes FOR ALL
USING (auth.uid() = user_id OR is_public = true);
```

**μ¥μ **:
- SQL λ λ²¨ λ³΄μ• (μ• ν”λ¦¬μΌ€μ΄μ… λ…λ¦½μ )
- μλ™ μ μ© (κ°λ°μ μ‹¤μ λ°©μ§€)
- SQL Injection λ°©μ–΄

---

## β… μ…λ ¥ κ²€μ¦ (Zod)

```typescript
import { z } from 'zod';

const createNodeSchema = z.object({
  title: z.string().min(1).max(200),
  content: z.string().max(50000),
  tags: z.array(z.string().max(20)).max(10),
});

// μ‚¬μ©
const result = createNodeSchema.safeParse(data);
if (!result.success) {
  throw new Error(result.error.message);
}
```

---

## π”’ λ³΄μ• ν—¤λ” (Netlify)

```toml
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
    X-XSS-Protection = "1; mode=block"
    Referrer-Policy = "strict-origin-when-cross-origin"
```

---

## π’΅ λ©΄μ ‘ ν¬μΈνΈ

### "RLSλ΅ λ°μ΄ν„°λ¥Ό λ³΄νΈν•λ” λ°©λ²•μ€?"
> "**SQL λ λ²¨ λ³΄μ•**μΌλ΅ `auth.uid() = user_id` μ΅°κ±΄μ΄ μλ™ μ μ©λ©λ‹λ‹¤. μ• ν”λ¦¬μΌ€μ΄μ… μ½”λ“κ°€ μ•„λ‹ λ°μ΄ν„°λ² μ΄μ¤μ—μ„ λ³΄νΈν•λ―€λ΅ **SQL Injectionμ—λ„ μ•μ „**ν•©λ‹λ‹¤."

---

**λ‹¤μ λ¬Έμ„**: [12. ν”„λ΅λ•μ… λ°°ν¬](./12_ν”„λ΅λ•μ…_λ°°ν¬.md)
**μ΄μ „ λ¬Έμ„**: [10. μ„±λ¥ μµμ ν™”](./10_μ„±λ¥_μµμ ν™”.md)
